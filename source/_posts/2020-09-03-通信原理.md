---
title: "通信原理笔记"
date: 2020-09-03T15:30:00+08:00
categories: 通信原理
tags:		["学习"]
---

# 通信原理笔记

$c = [b|m] = m [P|I_k] = m G$，G 为生成矩阵，b 为校验位，m 为信息位，c 为码字

校验矩阵 $H = [I_{n-k}|P^T]$

## 概念

- 导频：为测量或监控的目的而发送的信号
- 信道估计：从接收数据中将假定的某个信道模型的模型参数（一般指信道矩阵）估计出来
- 信道矩阵：传输概率矩阵
- 信道状态信息：接收端评估 CSI 并将其量化反馈给发送端。包含 信道矩阵，信号散射，环境衰弱，距离衰弱 等

## 外文缩写

- BP：置信传播 or 反向传播
- CSI：信道状态信息
- FDD：频分双工
- MMSE：最小均方误差
- BCJR：一种定义在网格图上的用来最大化纠错编码的后验概率的算法，主要用于卷积编码。

## 生词表

- interleaver：交织器
- permute：排列

## LDPC

LDPC 与 Turbo 码都属于 compound code（系列码）

### Turbo 码

[Turbo 码: 一个辉煌时代的落幕](https://zhuanlan.zhihu.com/p/23112534)

要想尽可能逼近香农信道容量的理论极限，就要不停增大线性分组码的码字长度，以至于最大似然解码器的计算复杂度不断提升，最终物理上都不可能实现这样的解码器。

Turbo 的编码器非常简单，由两个并行的卷积码编码器组成。所谓卷积码，即输出为输入和一段已知序列的卷积。与其对应的分组码则是将序列分段，每段序列和编码矩阵相乘得到输出序列（在后续发展中，Turbo 码也拥有了分组码版本）。在 Turbo 码中，输入序列 在进入第二个编码器时须经过一个交织器 (Interleaver)，用于将序列打乱。两个编码器的输出(Output I 和 II)共同作为校验信息添加到信息序列(Systematic output)之后，对抗信道引起的错误。

Turbo 码 使用伪随机交织器，其目的是：
1. 将 一半的turbo码中 容易产生的错误 与 另一半中 不太可能产生的错误绑定
2. 在遇到匹配错误的解码时仍能有稳定的表现，这种错误的解码在信道统计信息未知或错误时常见。

![](turbo.png)此处 output 就是 parity

值得注意的是，Turbo码的强大主要来源于其解码器。从下图 Turbo 码解码器中可以看到，整个解码过程与编码过程形成对应关系，信息序列 (Systematic data) 和相应的校验序列 (Parity 1 and 2) 分别输入两个解码器，而后各自的输出经过一个减法运算并通过交织和解交织( Deinterleaver) 后反馈给另一个解码器。
**Turbo 的核心正是这一减法和反馈，图中由红线标注。这一小小的连线堪称上帝之手，它将解码技术，甚至是信息理论推向了一个新的时代。**
为什么要做减法呢? 因为输出信息被分解为内信息 (intrinsic information) 和外信息 (extrinsic information)，通过减法从输出信息中取出外信息并将其反馈给另一个解码器。**在迭代解码过程中，接收信息错误不断地被纠正，最后无限逼近香农极限。整个解码过程信息在两个极为简单的解码器间不断地轮转，像一台无比强大的涡轮机，因而得名Turbo。**

![](turbo2.png)

#### RSC 码

RSC（recursive systematic convolutional）码

### LDPC

[LDPC 码的基本原理 | 带你读《5G-NR信道编码》之七](https://developer.aliyun.com/article/739523)

LDPC相对于 turbo 码的优势就在于
- 没有低权重码字：码字的hamming距得以增大，获得更小的误码率
- 低复杂度的交互式解码：使用简单的校验 网格

#### 构造 LDPC

LDPC 码的校验阵为稀疏矩阵 A，即 0 的数量远大于 1。

通常用 $(n, t_c, t_r)$ 来描述一个 LDPC 码，其中 $n$ 为分组长度，$t_c$ 为各列码重，$t_r$ 为各行码重，且 $t_r>t_c$。

有 $r=1-\frac{t_c}{t_r}$

还需检验有效性：令 $\rho$ 代表 A 中 1 的密度，则可得 $t_c=\rho(n-k), t_r=\rho n$，其中 n - k 为 A 的行数，n 为列数（譬如分段长）
故有 $\frac{t_c}{t_r}=1-\frac{k}{n}$

#### 规则 LDPC 和非规则 LDPC

LDPC 码可以用二分图表示，其中有两种节点：变量节点 和 校验节点

- 规则 LDPC：每个校验节点连接的变量节点数（3）一致，每个变量节点连接的校验节点数（2）也一致；即：每行有 3 个非零元素，每列有 2 个非零元素
- 非规则 LDPC：每个节点的自由度可以不一样，但是需要满足：
$$变量节点自由度\lambda(x)=\sum^{d_v}_{i=2}\lambda_ix^{i-1}$$
$$校验节点自由度\rho(x)=\sum^{d_c}_{i=2}\rho_ix^{i-1}$$
系数$\lambda_i$和$\rho_i$分别表示自由度为$i$的从变量节点和校验节点发出的边数所占的比例

然而实际上非规则 LDPC 更灵活，更常用

#### 置信传播



<!-- # LDPC 码的基本原理 | 带你读《5G-NR信道编码》之七

**简介：** <span>本节将为你详细介绍LDPC 码的基本原理 。

# 低密度校验码（LDPC）

### [2.1 LDPC的产生与发展](https://developer.aliyun.com/article/739484)

## | 2.2　LDPC 码的基本原理 |

### 2.2.1　Gallager 码

LDPC 码是一种分组校验码，由 Gallager 于 1963 年提出 [1-2]。在其博士论 文 [2] 中，除了对性能界的详尽分析之外，Gallager 还建议了两种解码方法：一 种是简单的代数法解码；另一种是基于概率论的解码。  
论文 [1-2] 所想表达的一个思想是，尽管 LDPC 的“低重”特性从码距的角 度不具有很强的优势，但稀疏阵结构可以降低解码的计算量，在性能与工程实 现复杂度之间提供一个折中。在之后的近 40 多年，LDPC 经历了一段相对沉寂 的时期。部分的原因是基于概率论解码的复杂度要比代数法解码高很多，即使 采用稀疏权重的设计，对于当时的硬件，其成本还是难以接受。  
另一个原因是对概率论解码的认识本身，包括其性能潜力。传统信道编码 理论评判一个码的性能大多是基于码距分析的，通过最小码距及码距的分布， 得到性能界的解析表达式，从而比较“严格”地推断出该信道编码的纠错能力。 这类方法对较短码长且基于代数法解码的分组码十分有效，但当码长较长且采 用概率论的解码，就显得不那么有力。LDPC 码的优势在于长码和运用概率方 法解码。因此在很长的一段时间中，它的潜力并没有被学术界和工业界所广泛认识。  
1993 年 Turbo 码 [7] 的出现掀起了业界对概率法解码的热潮。所谓概率法 解码，即采用软的信息比特，而不是代数式译码中的“对”或“错”的硬判决。“软”体现在每个比特位的置信度是一个概率分布，即一个实数，相当于“对” 与“错”之间渐变的“灰度”。概率法解码一般需要与迭代译码相结合，才会 体现其优势。仿照 Turbo 译码原理，大家又重新发现最初 Gallager 所提的 LDPC 的概率法解码就是采用迭代译码的。而且 Turbo 和 LDPC 都可以用因子 图（Factor Graph）[16] 的分析手段统一起来，所用的解码方法也可以归类为人 工智能当中的置信传播（Belief Propagation）算法 [17] 或者信息传递（Message Passing）[18]。  
经典的 LDPC 编码器可以按如下描述。一个长度为 k 的二元的信息比特序 列 u，引入 m 个校验比特后，生成 n 个编码比特的序列 t，此 时码率为 k/n。因 为是线性码，码字 t 可以用 u 乘以一个生成矩阵 GT 来表示：  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/4d8023ad38474007bf7a50abdf84435c.png "image.png")  
生成矩阵 GT 包含两部分：  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/7486c14ebfad4eb4ac0681ede7db3305.png "image.png")  
如果采用硬判决的代数法译码，相应的校验矩阵可以写成：  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/59c9caf3a1724b4391272aefa6860fe8.png "image.png")  
当码字在传输中没有错误时，奇偶校验通过，即，  

![image.png](https://ucc.alicdn.com/pic/developer-ecology/d4e30df65d8649a48503c5da9cd44559.png "image.png")

其中，第一个值为t的估值。需要指出的是，LDPC校验矩阵有时不一定写成右边为单位矩阵的形式，尤其当采用概率译码（如软信息的置信度传播）方式。此时需要对校验矩阵做一些线性代数的变换，求出生成矩阵以便编码。  
LDPC的特点在于行数为m，列数为n的校验矩阵A具有稀疏性，即多数的元素为0，矩阵A的产生方法有随机生成、结构化设计或者穷举寻找，详细请见后述（第2.3节和第2.5.3节）。  
一个LDPC编码后的码块通过AWGN信道的框图如图2-2所示：  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/de9fc2ca725c45b3a21b0f7a25e151a5.png "image.png")  
在图2-2中，信息比特流u先进行编码。编码后的比特流t经过AWGN信道，输出为观测到的序列 y。LDPC 解码器进行变量节点和校验节点之间的反 复迭代交换软信息，若干次迭代后，解码器输出硬判决结果，即解码后的信息 比特序列u的估计值。  
LDPC 校验矩阵 A 的稀疏性的必要性在于：

*   LDPC 采用的是“加和乘”（Sum-product）的译码算法。该算法只有当二 分图（Bipartite）中没有环（Cycle-free），或者没有短环（Short Cycle）时才能 达到较好的性能。而稀疏性可以大大降低短环出现的可能性；
*   稀疏性意味着变量节点和校验节点之间的连接密度不高，这样在做“加和 乘”的译码时可以减少累加和相乘的运算，降低译码的复杂度；
*   当校验矩阵 A 是稀疏阵时，其相应的生成矩阵 GT 通常不具有稀疏性，这说明产生的编码序列t的编码权重有可能较高，从而具有较好的编码矩阵。

### 2.2.2　规则 LDPC 和非规则 LDPC

LDPC编码可以用二分图的方法表述，根据图2-3所示的LDPC二分图（Bipartite）。规则LDPC，每个变量节点（Yi,i=1,2,3,…,9，为列的编号；有 9 个输入变量节点）连接q=2个校验节点（Ai,i=1,2,3,…,6；行的编号；有 6 行 参与校验；q 为列重—这一列中“1”的个数），每个检验节点连接r=3个变量节点（r 为行重，即等于这一行中“1”的个数）。  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/720b84bcbee04153b4fa94a2063b14e7.png "image.png")  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/802d45413ace4fbe92bd5992e7e97ed5.png "image.png")  
从图 2-3 中可以看出，节点分成两大类型：变量节点（Variable Nodes）和校验节点（Check Nodes）。同一类型的节点不能直接彼此相连，不能直接互 通信息，但可以通过另一个类型的节点传递信息。这种互联结构体现于网状的 连线，也称“边”（Edge），可以完全由校验矩阵决定。  
LDPC 可以分为规则（Regular）和非规则（Irregular）[8] 两种。规则的 LDPC 是指同一种类型的节点具有相同的自由度。这里的自由度是与各节点类 型的边数目，即对于 LDPC 码来说，相当于校验矩阵中每行或者每列上的非零 元素数目。图 2-3 就是一个规则 LDPC 的例子，其中每个校验节点与 3 个变量节 点相连，而每个变量节点与 2 个校验节点相连。对应到校验矩阵，即每行有 3 个非 零元素，dc = 3。每列有 2 个非零元素，dv = 2。与 6×9 的整个校验矩阵来看，还 是比较“稀疏”的。当 LDPC 码非常大时，其稀疏性就更为明显。  
非规则 LDPC 的变量节点或者校验节点的自由度可以不一样，只要服从某 种分布即可。用一对参数（λ, ρ）式子表示非规则 LDPC，其中  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/4b4be895c8eb4e028cf7f53b448742e1.png "image.png")  
代表了变量节点的自由度分布。而  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/638e72de20ee476c84b4331fffe9895e.png "image.png")  
代表了校验节点的自由度分布。更精确的讲，系数λi和ρi分别表示自由度为i的从变量节点和校验节点发出的边数所占的比例。上面的两个公式也可以用来描述规则的LDPC，例如，图2-3的LDPC就可以写成`λ（x）:=x^1`和`ρ(x):=x^2`。  
相比规则LDPC，非规则LDPC有更大的灵活性和优化空间。无论从理论分析还是仿真验证，非规则LDPC的性能更优。因此在工程上所考虑的LDPC都是非规则的LDPC。

### 2.2.3 置信度传播的基本原理及其应用

置信度传播（Belief Propagation）也被称为信息传送（Message Passing），是概率论中的一种基本算法，guangfanyingyongza广泛应用在数字通信、人工智能、计算机科学、运筹管理等领域。  
我们把图2-4一般化成一个因子图（Factor Graph），由变量节点（Variable Notes）和因子节点（Factor Notes）组成。  
一般地置信度传播或者信息传送算法的本质就是根据因子图中变量节点和因子节点的连接关系，计算变量节点取值的边缘概率分布。这里有一个基本假设，即变量节点之间、因子节点之间都是不相关的，它们的联合概率分布可 以表示成边缘概率的乘积。边缘概率的求解可以用树状结构图表示。因子图展 开成树状图之后（这里假设不存在环状结构），可以更直观地看出迭代译码的过程，如图 2-5 所示。  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/53493d2963ff4deb991d39ec424b39f2.png "image.png")  
从因子节点a到变量节点i的信息mga i(x； ) 可以解释成因子节点a有多大的可能性认为节点i会处于状态x；c而对于变量节点i，它处于状态x，的联合置信度正比于与它相连的因子节点认为变量节点会处于状态x；的概率的乘积，即  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/c1db6f43cd864c2cbc2e60bb6adaebd1.png "image.png")  
对于任意一个因子节点A，它的置信度等价于与它相连的所有变量节点的联合置信度。用式(2-12)表示  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/7f2108e0f06b43668b964e2263edb259.png "image.png")  
注意这里的L是个集合的概念。那么根据式(2-11)，变量节点集合L中的每一个节点的置信度都是由正比于与它相连的因子节点认为变量节点会处于状态x，的概率的乘积，因此这个联合概率可以写成：  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/d7ba7880d41a48b9b64c38ec53c965c7.png "image.png")  
一个节点上的置信度，也就是边缘概率，就等于除了它自己，对所有相连的因子节点的联合置信度求和，即：  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/9a1876fcb93841958b1c0f2862f681df.png "image.png")  
式(2-15)可以写成迭代形式。对于能够展成树形图的结构，而且不存在局部的环状结构，可以证明：置信度传播算法能够在有限的迭代次数内(两倍的树形结构的最大深度)收敛到边缘概率。  
在实际的因子图展开当中， 局部可能会出现迂回环状结构(LoopyGraph) ， 如图2-6所示。当有环结构存在时， 置信度传播算法有可能不收敛，或者即使收敛，也不一定收敛到边缘概率分布。解决环结构不收敛的方法有好几种，对环结构的研究具有更多的理论意义，对工程设计的指导有限，这里不再赘述。  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/7238e4e7752045e69340ea06cbc19208.png "image.png")  
在信道解码方面，置信度传播被用在多种编码当中。这里我们介绍在 LDPC 中的应用。LDPC 校验矩阵的每一行代表一个奇偶校验，传统的代数译 码只考察相对应的比特节点上的值相加之和是否为 0，如果是，奇偶校验通过； 反之，校验不通过。在概率译码当中，校验节点，也就是一般的因子图中的因 子节点，需要计算的是该校验通过的概率。而这个计算是假定某一个相连的变 量比特是 1（或者 0），并且其他变量节点的值符合某种先验的概率分布。变量 节点需要计算的是一个比特是 1（或者 0）的概率，这个计算是基于所有相连的校验节点上的校验通过概率。  
用 rij 代表由校验节点确定的信息概率，更具体的，用 rij0 代表当信息比特 ti 为 0 时，校验节点j能够校验通过的概率。同理，用rij1 代表当信息比特ti 为 1 时， 校验节点 j 能够校验通过的概率。那么，根据置信度传播算法的原理，这两个 信息概率可以用式（2-17）来计算：  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/3f05b6a900b343339cf0403e8619ff8b.png "image.png")  
在式(2-17) 中， 表达式ie row[j] /(表示在第j行的所有为1的比特索引，除去当前的比特索引i。概率qy由变量节点来计算。q，表示在给定所有的校验节点的信息(除去校验节点j)的条件下，t；=0的概率。同理，q；表示在给定所有的校验节点的信息(除去校验节点j)的条件下，t；=1的概率。根据置信度传播的算法原理，概率q；可以表达成：  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/c7f3c59e3d134570a69780ccf2b53d2a.png "image.png")  
在式(2-18) 中， j ecol[i] /(j) 表示在第i列的所有为1的校验节点索引，除去当前的校验节点索引j。系数aiy是用来归一化的， 以保证q； +q； =1。式子中的p?和pi是相对于当前一轮迭代译码的第i个信息比特的先验概率，由以前的迭代过程得到。外部信息(Extrinsic Information) e； 和e， 的计算公式为：  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/4711ca5b8cb74e399c23edc1ddd6b782.png "image.png")  
![image.png](https://ucc.alicdn.com/pic/developer-ecology/ed66390f87e94126b50dd25b4a3ff8f3.png "image.png") -->
